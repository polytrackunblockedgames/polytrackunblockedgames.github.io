<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unblocked Games 66, 76, WTF - Play 250+ Free Games at School | PolyTrack</title>
    <meta name="description" content="Play 250+ unblocked games at school or work FREE! PolyTrack, Slope, Retro Bowl, 1v1 LOL, Run 3, and more. No downloads, no blocks. Best unblocked games 2025 - play instantly!">
    <meta name="keywords" content="unblocked games, unblocked games 66, unblocked games 76, unblocked games wtf, games unblocked, polytrack unblocked, slope unblocked, retro bowl unblocked, run 3 unblocked, 1v1 lol unblocked, unblocked games at school, unblocked games for school, free unblocked games, play unblocked games">
    <meta name="author" content="PolyTrack Unblocked Games">
    
    <!-- Open Graph -->
    <meta property="og:title" content="PolyTrack Unblocked Games - Play Free Games Online">
    <meta property="og:description" content="Play 250+ free unblocked games instantly. No downloads required.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://polytrackunblockedgames.github.io/">
    <meta property="og:image" content="https://polytrackunblockedgames.github.io/assets/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/img/icon/main.png">
    <link rel="canonical" href="https://polytrackunblockedgames.github.io/">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "PolyTrack Unblocked Games",
        "url": "https://polytrackunblockedgames.github.io/",
        "description": "Play 250+ unblocked games at school or work FREE! PolyTrack, Slope, Retro Bowl, 1v1 LOL, Run 3, and more.",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://polytrackunblockedgames.github.io/?search={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "GameServer",
        "name": "PolyTrack Unblocked Games",
        "url": "https://polytrackunblockedgames.github.io/",
        "description": "Free unblocked games portal with 250+ games",
        "game": {
            "@type": "VideoGame",
            "name": "Unblocked Games Collection",
            "gameItem": "250+ free browser games"
        }
    }
    </script>
    
        <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBPRR2NP');</script>
<!-- End Google Tag Manager -->
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VE9J0CCHWZ"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VE9J0CCHWZ');
    </script>
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* PolyTrack Color Scheme - Navy Blue Theme */
            --primary: #c5d9f7;
            --primary-dark: #9ab5e3;
            --secondary: #1a2944;
            --tertiary: #2d4a73;
            --accent: #7a9ed4;
            --accent-glow: rgba(197, 217, 247, 0.3);
            
            /* Base Colors */
            --bg-primary: #0f1823;
            --bg-secondary: #1a2944;
            --bg-tertiary: #2d4a73;
            --text-primary: #ffffff;
            --text-secondary: #c5d9f7;
            --text-muted: #7a9ed4;
            
            /* UI Elements */
            --border-color: rgba(197, 217, 247, 0.1);
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.4);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="light"] {
            --bg-primary: #f0f4f8;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e6eef5;
            --text-primary: #1a2944;
            --text-secondary: #2d4a73;
            --text-muted: #5a7aa0;
            --border-color: rgba(42, 74, 115, 0.15);
            --shadow: 0 2px 15px rgba(26, 41, 68, 0.1);
            --shadow-lg: 0 8px 30px rgba(26, 41, 68, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header */
        header {
            background: var(--bg-secondary);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--border-color);
            box-shadow: var(--shadow);
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            letter-spacing: 1px;
        }

        .logo i {
            color: var(--accent);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            width: 45px;
            height: 45px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background: var(--tertiary);
            border-color: var(--primary);
            transform: scale(1.05);
        }

        /* Search Section */
        .search-section {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--tertiary) 100%);
            padding: 3rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .search-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, var(--accent-glow) 0%, transparent 50%);
            pointer-events: none;
        }

        .search-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .search-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .search-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .search-input {
            width: 100%;
            padding: 1.2rem 4rem 1.2rem 3.5rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            font-size: 1.1rem;
            color: var(--text-primary);
            outline: none;
            transition: var(--transition);
        }

        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--accent-glow);
        }

        .search-icon {
            position: absolute;
            left: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 1.2rem;
        }

        .random-btn {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: var(--secondary);
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .random-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-50%) scale(1.05);
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .stat-item i {
            color: var(--primary);
        }

        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Filters */
        .filters-section {
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.7rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            background: var(--bg-tertiary);
        }

        .filter-btn.active {
            background: var(--primary);
            color: var(--secondary);
            border-color: var(--primary);
        }

        .view-controls {
            display: flex;
            gap: 0.5rem;
        }

        .view-btn {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            width: 45px;
            height: 45px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .view-btn:hover,
        .view-btn.active {
            background: var(--primary);
            color: var(--secondary);
            border-color: var(--primary);
        }

        /* Dropdown */
        .dropdown {
            position: relative;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 0.5rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            min-width: 200px;
            box-shadow: var(--shadow-lg);
            z-index: 100;
            padding: 0.5rem;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-item {
            padding: 0.8rem 1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition);
            color: var(--text-primary);
        }

        .dropdown-item:hover {
            background: var(--bg-tertiary);
            color: var(--primary);
        }

        /* Category Pills */
        .category-pills {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 16px;
        }

        .category-pill {
            padding: 0.6rem 1.2rem;
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .category-pill:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .category-pill.active {
            background: var(--primary);
            color: var(--secondary);
            border-color: var(--primary);
        }

        /* Results Count */
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .results-count {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .games-grid.list-view {
            grid-template-columns: 1fr;
        }

        .game-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid var(--border-color);
            position: relative;
        }

        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .game-image-container {
            position: relative;
            width: 100%;
            padding-top: 100%;
            overflow: hidden;
            background: var(--bg-tertiary);
        }

        .game-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .game-card:hover .game-image {
            transform: scale(1.1);
        }

        .game-hover-actions {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            gap: 1rem;
            opacity: 0;
            transition: var(--transition);
        }

        .game-card:hover .game-hover-actions {
            opacity: 1;
        }

        .hover-action-btn {
            background: var(--primary);
            color: var(--secondary);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .hover-action-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .game-info {
            padding: 1.2rem;
        }

        .game-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .game-category {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border-radius: 6px;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .game-stats {
            display: flex;
            gap: 1rem;
            margin-top: 0.8rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .game-stat {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .game-stat i {
            color: var(--primary);
        }

        .favorite-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(26, 41, 68, 0.9);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            z-index: 10;
        }

        .favorite-btn:hover,
        .favorite-btn.active {
            background: var(--primary);
            color: var(--secondary);
        }

        .playtime-indicator {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: var(--bg-tertiary);
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* List View */
        .games-grid.list-view .game-card {
            display: grid;
            grid-template-columns: 150px 1fr auto;
            gap: 1.5rem;
            align-items: center;
        }

        .games-grid.list-view .game-image-container {
            padding-top: 0;
            height: 150px;
        }

        .games-grid.list-view .game-info {
            flex: 1;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--primary);
            transform: translateY(150%);
            transition: var(--transition);
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .toast.active {
            transform: translateY(0);
        }

        /* Footer */
        footer {
            background: var(--bg-secondary);
            padding: 2rem;
            margin-top: 4rem;
            text-align: center;
            border-top: 2px solid var(--border-color);
        }

        .footer-text {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        .loading i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .search-title {
                font-size: 1.8rem;
            }

            .logo {
                font-size: 1.4rem;
            }

            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 1rem;
            }

            .stats-bar {
                gap: 1rem;
            }

            .filters-section {
                flex-direction: column;
                align-items: stretch;
            }

            .games-grid.list-view .game-card {
                grid-template-columns: 100px 1fr;
            }

            .games-grid.list-view .game-image-container {
                height: 100px;
            }
        }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PLACEHOLDER"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="/" class="logo">
                <i class="fas fa-gamepad"></i>
                PolyTrack
            </a>
            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-sun"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Search Section -->
    <section class="search-section">
        <div class="search-container">
            <h1 class="search-title">Play Unblocked Games Instantly</h1>
            <p class="search-subtitle">250+ free games - No downloads, no restrictions</p>
            
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="Search games... (press / to focus)"
                       autocomplete="off">
                <button class="random-btn" id="randomBtn">
                    <i class="fas fa-random"></i> Random
                </button>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <i class="fas fa-fire"></i>
                    <span id="streakCount">0 days</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-gamepad"></i>
                    <span id="gamesPlayedCount">0 played</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-heart"></i>
                    <span id="favoritesCount">0 favorites</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-clock"></i>
                    <span id="totalPlaytime">0h</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container">
        <!-- Category Pills -->
        <div class="category-pills" id="categoryPills">
            <div class="category-pill active" data-category="all">
                <i class="fas fa-th"></i> All Games
            </div>
        </div>

        <!-- Filters -->
        <div class="filters-section">
            <div class="filter-group">
                <div class="dropdown">
                    <button class="filter-btn" id="sortBtn">
                        <i class="fas fa-sort"></i> Sort
                    </button>
                    <div class="dropdown-content" id="sortDropdown">
                        <div class="dropdown-item" data-sort="alphabetical">A-Z</div>
                        <div class="dropdown-item" data-sort="popular">Most Popular</div>
                        <div class="dropdown-item" data-sort="newest">Newest First</div>
                        <div class="dropdown-item" data-sort="rating">Highest Rated</div>
                        <div class="dropdown-item" data-sort="playtime">Most Played</div>
                    </div>
                </div>
            </div>

            <div class="view-controls">
                <button class="view-btn active" data-view="grid" title="Grid View">
                    <i class="fas fa-th"></i>
                </button>
                <button class="view-btn" data-view="list" title="List View">
                    <i class="fas fa-list"></i>
                </button>
            </div>
        </div>

        <!-- Results Header -->
        <div class="results-header">
            <div class="results-count" id="resultsCount">Loading games...</div>
        </div>

        <!-- Games Grid -->
        <div class="games-grid" id="gamesContainer">
            <div class="loading">
                <i class="fas fa-spinner"></i>
                <p>Loading games...</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p class="footer-text">Â© 2025 PolyTrack Unblocked Games | Play free unblocked games online</p>
    </footer>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage"></span>
    </div>

    <script>
        let allGames = [];
        let filteredGames = [];
        let currentView = 'grid';
        let currentSort = 'alphabetical';
        let selectedCategories = ['all'];
        const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
        let userData = JSON.parse(localStorage.getItem('userData')) || {
            playedGames: {},
            favorites: [],
            ratings: {}
        };

        // Ensure ratings property exists
        if (!userData.ratings) {
            userData.ratings = {};
        }

        // Theme management
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const savedTheme = localStorage.getItem('theme') || 'dark';
        html.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });

        function updateThemeIcon(theme) {
            themeToggle.innerHTML = theme === 'dark' 
                ? '<i class="fas fa-sun"></i>' 
                : '<i class="fas fa-moon"></i>';
        }

        // Toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            toastMessage.textContent = message;
            toast.classList.add('active');
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // Streak calculation
        function updateStreak() {
            const streakData = JSON.parse(localStorage.getItem('playStreak') || '{}');
            const today = new Date().toISOString().slice(0,10);
            const yesterday = new Date(Date.now() - 86400000).toISOString().slice(0,10);
            
            let currentStreak = streakData.current || 0;
            const lastPlayDate = streakData.lastDate;
            
            if (lastPlayDate === today) {
                // Already played today
            } else if (lastPlayDate === yesterday) {
                // Continue streak
                currentStreak++;
                streakData.current = currentStreak;
                streakData.lastDate = today;
                streakData.best = Math.max(streakData.best || 0, currentStreak);
                localStorage.setItem('playStreak', JSON.stringify(streakData));
            } else if (!lastPlayDate) {
                // First time
                currentStreak = 1;
                streakData.current = currentStreak;
                streakData.lastDate = today;
                streakData.best = 1;
                localStorage.setItem('playStreak', JSON.stringify(streakData));
            }
            
            document.getElementById('streakCount').textContent = `${currentStreak} day${currentStreak !== 1 ? 's' : ''}`;
        }

        // Update user stats
        function updateUserStats() {
            const gamesPlayed = Object.keys(userData.playedGames || {}).length;
            document.getElementById('gamesPlayedCount').textContent = gamesPlayed;

            let totalSeconds = 0;
            Object.values(userData.playedGames || {}).forEach(game => {
                totalSeconds += game.playtime || 0;
            });
            const hours = Math.floor(totalSeconds / 3600);
            document.getElementById('totalPlaytime').textContent = hours + 'h';

            document.getElementById('favoritesCount').textContent = favorites.length;
        }

        // Load games
        async function loadGames() {
            try {
                const response = await fetch('https://ubghyper.github.io/assets/games.json');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                allGames = await response.json();
                allGames = allGames.filter(game => game && game.name && game.url);
                filteredGames = [...allGames];
                populateCategories();
                sortGames();
                renderGames();
                updateUserStats();
                updateStreak();
            } catch (error) {
                console.error('Error loading games:', error);
                document.getElementById('gamesContainer').innerHTML = '<p style="text-align:center;color:var(--text-secondary);">Error loading games. Please try again later.</p>';
            }
        }

        // Populate categories
        function populateCategories() {
            const categories = new Set();
            allGames.forEach(game => {
                if (game.tags && Array.isArray(game.tags)) {
                    game.tags.forEach(tag => categories.add(tag));
                }
            });

            const categoryPills = document.getElementById('categoryPills');
            const allPill = categoryPills.querySelector('[data-category="all"]');
            
            Array.from(categories).sort().forEach(category => {
                const pill = document.createElement('div');
                pill.className = 'category-pill';
                pill.dataset.category = category;
                pill.textContent = category;
                pill.addEventListener('click', () => filterByCategory(category));
                categoryPills.appendChild(pill);
            });
        }

        // Filter by category
        function filterByCategory(category) {
            const pills = document.querySelectorAll('.category-pill');
            pills.forEach(p => p.classList.remove('active'));
            
            const selectedPill = document.querySelector(`[data-category="${category}"]`);
            if (selectedPill) selectedPill.classList.add('active');

            if (category === 'all') {
                selectedCategories = ['all'];
                filteredGames = [...allGames];
            } else {
                selectedCategories = [category];
                filteredGames = allGames.filter(game => 
                    game.tags && game.tags.includes(category)
                );
            }

            const searchValue = document.getElementById('searchInput').value.toLowerCase();
            if (searchValue) {
                filteredGames = filteredGames.filter(game =>
                    game.name.toLowerCase().includes(searchValue)
                );
            }

            sortGames();
            renderGames();
        }

        // Filter games by search
        function filterGames() {
            const searchValue = document.getElementById('searchInput').value.toLowerCase();
            
            if (selectedCategories.includes('all')) {
                filteredGames = allGames.filter(game =>
                    game.name.toLowerCase().includes(searchValue)
                );
            } else {
                filteredGames = allGames.filter(game =>
                    game.tags && game.tags.some(tag => selectedCategories.includes(tag)) &&
                    game.name.toLowerCase().includes(searchValue)
                );
            }

            sortGames();
            renderGames();
        }

        // Calculate game rating
        function calculateGameRating(gameUrl) {
            return userData.ratings[gameUrl] || 0;
        }

        // Get game playtime
        function getGamePlaytime(gameUrl) {
            return userData.playedGames[gameUrl]?.playtime || 0;
        }

        // Format playtime
        function formatPlaytime(seconds) {
            if (seconds < 60) return `${seconds}s`;
            if (seconds < 3600) return `${Math.floor(seconds / 60)}m`;
            return `${Math.floor(seconds / 3600)}h`;
        }

        // Format number
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        // Render games
        function renderGames() {
            const container = document.getElementById('gamesContainer');
            const viewClass = currentView === 'list' ? 'list-view' : '';
            container.className = `games-grid ${viewClass}`;

            if (filteredGames.length === 0) {
                container.innerHTML = '<p style="text-align:center;color:var(--text-secondary);grid-column:1/-1;">No games found. Try a different search or category.</p>';
                document.getElementById('resultsCount').textContent = '0 games';
                return;
            }

            container.innerHTML = filteredGames.map(game => {
                const isFavorite = favorites.includes(game.url);
                const plays = userData.playedGames[game.url]?.plays || 0;
                const playtime = getGamePlaytime(game.url);
                const rating = calculateGameRating(game.url);

                return `
                    <div class="game-card" data-url="${game.url}">
                        <button class="favorite-btn ${isFavorite ? 'active' : ''}" data-url="${game.url}">
                            <i class="${isFavorite ? 'fas' : 'far'} fa-heart"></i>
                        </button>
                        <div class="game-image-container">
                            <img src="https://ubghyper.github.io/GameList.github.io/${game.url}/${game.image}" 
                                 alt="${game.name}" 
                                 class="game-image"
                                 onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22%3E%3Crect fill=%22%232d4a73%22 width=%22400%22 height=%22400%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22%23c5d9f7%22 font-family=%22Arial,sans-serif%22 font-size=%2220%22%3E' + encodeURIComponent('${game.name}') + '%3C/text%3E%3C/svg%3E'">
                            <div class="game-hover-actions">
                                <button class="hover-action-btn" title="Play Now" data-action="play">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        </div>
                        <div class="game-info">
                            <h3 class="game-title">${game.name}</h3>
                            <span class="game-category">${game.tags && game.tags[0] ? game.tags[0] : 'Game'}</span>
                            <div class="game-stats">
                                <span class="game-stat">
                                    <i class="fas fa-play-circle"></i> ${formatNumber(plays)}
                                </span>
                                <span class="game-stat">
                                    <i class="fas fa-star"></i> ${rating || 'N/A'}
                                </span>
                            </div>
                            ${playtime > 0 ? `
                                <div class="playtime-indicator">
                                    <i class="fas fa-clock"></i> You played ${formatPlaytime(playtime)}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('resultsCount').textContent = `${filteredGames.length} game${filteredGames.length !== 1 ? 's' : ''}`;

            // Add event listeners
            document.querySelectorAll('.game-card').forEach(card => {
                const gameUrl = card.dataset.url;
                
                card.addEventListener('click', (e) => {
                    if (e.target.closest('.favorite-btn') || e.target.closest('.hover-action-btn')) return;
                    window.location.href = `play.html?game=${encodeURIComponent(gameUrl)}`;
                });

                const playBtn = card.querySelector('[data-action="play"]');
                if (playBtn) {
                    playBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        window.location.href = `play.html?game=${encodeURIComponent(gameUrl)}`;
                    });
                }
            });

            document.querySelectorAll('.favorite-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleFavorite(btn.dataset.url);
                });
            });
        }

        // Toggle favorite
        function toggleFavorite(gameUrl) {
            const index = favorites.indexOf(gameUrl);
            if (index > -1) {
                favorites.splice(index, 1);
                showToast('Removed from favorites');
            } else {
                favorites.push(gameUrl);
                showToast('Added to favorites!');
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            renderGames();
            updateUserStats();
        }

        // Sort games
        function sortGames() {
            switch(currentSort) {
                case 'popular':
                    filteredGames.sort((a, b) => {
                        const playsA = userData.playedGames[a.url]?.plays || 0;
                        const playsB = userData.playedGames[b.url]?.plays || 0;
                        return playsB - playsA;
                    });
                    break;
                case 'alphabetical':
                    filteredGames.sort((a, b) => {
                        const nameA = (a.name || '').toLowerCase();
                        const nameB = (b.name || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                    break;
                case 'rating':
                    filteredGames.sort((a, b) => {
                        const ratingA = calculateGameRating(a.url) || 0;
                        const ratingB = calculateGameRating(b.url) || 0;
                        return ratingB - ratingA;
                    });
                    break;
                case 'newest':
                    filteredGames.sort((a, b) => (b.new ? 1 : 0) - (a.new ? 1 : 0));
                    break;
                case 'playtime':
                    filteredGames.sort((a, b) => {
                        const timeA = getGamePlaytime(a.url);
                        const timeB = getGamePlaytime(b.url);
                        return timeB - timeA;
                    });
                    break;
            }
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', filterGames);

        document.getElementById('sortBtn').addEventListener('click', () => {
            document.getElementById('sortDropdown').classList.toggle('show');
        });

        document.querySelectorAll('#sortDropdown .dropdown-item').forEach(item => {
            item.addEventListener('click', () => {
                currentSort = item.dataset.sort;
                sortGames();
                renderGames();
                document.getElementById('sortDropdown').classList.remove('show');
                showToast(`Sorted by ${item.textContent}`);
            });
        });

        document.getElementById('randomBtn').addEventListener('click', () => {
            const randomGame = filteredGames.length > 0 
                ? filteredGames[Math.floor(Math.random() * filteredGames.length)]
                : allGames[Math.floor(Math.random() * allGames.length)];
            
            if (randomGame) {
                window.location.href = `play.html?game=${encodeURIComponent(randomGame.url)}`;
            }
        });

        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentView = btn.dataset.view;
                renderGames();
            });
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'INPUT') return;
            
            if (e.key === '/') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            } else if (e.key === 'r' && e.shiftKey) {
                e.preventDefault();
                document.getElementById('randomBtn').click();
            }
        });

        // URL search param
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('search');
        if (searchQuery) {
            document.getElementById('searchInput').value = searchQuery;
        }

        // Load games on page load
        loadGames();
    </script>
</body>
</html>